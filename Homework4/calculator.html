<!DOCTYPE html>
<html>
<head>
	<title>calculator</title>
	<link rel="stylesheet" type="text/css" href="calculator.css">
	<!-- <script type="text/javascript" src="calculator.js"></script> -->
	<script type="text/javascript">
		var stack = new Array();
		function show() {
			var x = stack.join("");
			document.getElementById("output").textContent = x;
		}
		function clear_() {
			stack.splice(0, stack.length);
			show();
		}
		function back(){
			stack.pop();
			show();
		}
		function update_stack(ele) {
			stack.push(ele);
			show();
		}
		function check_error(){
			var num_count = 0, operator_count = 0, left_brackets_count = 0, last_ele = 0, count = 0; // last ele: 1 stands for number, 2 stands for operator, 3 stands for LeftBracket, 4 stands for RightBracket;
			while (count < stack.length) {
				if(!isNaN(stack[count])){
					if(last_ele == 3) return false;
					else {
						last_ele = 1;
						count++;
						continue;
					}
				}
				else if(stack[count] == '('){
					if(last_ele == 1 || last_ele == 4) return false;
					else {
						left_brackets_count++;
						last_ele = 3;
						count++;
						continue;
					}
				}
				else if(stack[count] == ')'){
					left_brackets_count--;
					if(left_brackets_count < 0 || !(last_ele == 1 || last_ele == 4)) return false;
					else {
						last_ele = 4;
						count++;
						continue;
					}
				}
				else if(stack[count] == '+' ||stack[count] == '-' ||stack[count] == '*' ||stack[count] == '/') {
					if(last_ele != 1) return false;
					else {
						last_ele = 2;
						count++;
						continue;
					}
				}
				else 
					return false;
			}
			if(last_ele == 2 || last_ele == 3) return false;
			else return true;
		}		
		function calculate() {
			var x = stack.join("");
			if(check_error())
				document.getElementById("output").textContent = eval(x);
			else
				alert(x + " is invaild !");
		}
	</script>
</head>
<body>
	<p>Calculator</p>
	<div id="output"></div>
	<div id="first-raw-button">		
		<button id="7" onclick="update_stack(7)">7</button><button id="8" onclick="update_stack(8)">8</button><button id="9" onclick="update_stack(9)">9</button><button id="divide" onclick="update_stack('/')">/</button>			
	</div>
	<div id="second-raw-button">
		<button id="4" onclick="update_stack(4)">4</button><button id="5" onclick="update_stack(5)">5</button><button id="6" onclick="update_stack(6)">6</button><button id="multiply" onclick="update_stack('*')">*</button>				
	</div>
	<div id="third-raw-button">
		<button id="1" onclick="update_stack(1)">1</button><button id="2" onclick="update_stack(2)">2</button><button id="3" onclick="update_stack(3)">3</button><button id="subtract" onclick="update_stack('-')">-</button>						
	</div>
	<div id="fourth-raw-button">
		<button id="0" onclick="update_stack(0)">0</button><button id="point" onclick="update_stack('.')">.</button><button id="back" onclick="back()"><-</button><button id="add" onclick="update_stack('+')">+</button>
			
	</div>
	<div id="fifth-raw-button">
		<button id="left_brackets" onclick="update_stack('(')">(</button><button id="right_brackets" onclick="update_stack(')')">)</button><button id="clear_" onclick="clear_()">CE</button><button id="equal" onclick="calculate()">=</button>
			
	</div>


</body>
</html>